<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë¬¸ì œ ëª©ë¡</title>
  <style>
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #f2f2f2;
    }
    button {
      margin: 2px;
    }
#selectedCount {
  display: flex;
  align-items: center;
  gap: 20px;
}



  </style>
</head>
<body>

<h1>ë¬¸ì œ ëª©ë¡</h1>

<details open>
  <summary><strong>ğŸ” ë¬¸ì œ ê²€ìƒ‰</strong></summary>
  <div style="margin: 15px 0; border: 1px solid #ccc; padding: 10px; border-radius: 5px;">
    <label>ì œëª© ë˜ëŠ” ë³¸ë¬¸ë‚´ìš©: <input type="text" id="searchTitle"></label>
    <label>OR í¬í•¨ì–´: <input type="text" id="searchOrKeyword" placeholder="ì˜ˆ: í™•ë¥ , í•¨ìˆ˜"></label>
      <label>ì œì™¸í•  ë‹¨ì–´(NOT): <input type="text" id="searchNotKeyword" placeholder="ì˜ˆ: ì‚¼ê°í˜•"></label>
      <label>ê²€ìƒ‰ ëŒ€ìƒ:
      <select id="searchScope">
       <option value="title">ì œëª©ë§Œ</option>
      <option value="question">ë³¸ë¬¸ë§Œ</option>
      <option value="both" selected>ì œëª© + ë³¸ë¬¸</option>
      </select>
</label>

    <label>íƒœê·¸: <input type="text" id="searchTags"></label>
    <label>ì¶œì²˜:
      <select id="searchSource">
        <option value="">ì „ì²´</option>
        <option value="ë¬¸ì œì§‘">ë¬¸ì œì§‘</option>
        <option value="ì¤‘ë“±ê¸°ì¶œ">ì¤‘ë“±ê¸°ì¶œ</option>
        <option value="ì¼ë°˜ê³ ê¸°ì¶œ">ì¼ë°˜ê³ ê¸°ì¶œ</option>
        <option value="ê³¼í•™ê³ ê¸°ì¶œ">ê³¼í•™ê³ ê¸°ì¶œ</option>
        <option value="ìì‚¬ê³ ê¸°ì¶œ">ìì‚¬ê³ ê¸°ì¶œ</option>
        <option value="ìˆ˜ëŠ¥ëª¨ì˜ê³ ì‚¬ê¸°ì¶œ">ìˆ˜ëŠ¥ëª¨ì˜ê³ ì‚¬ê¸°ì¶œ</option>
        <option value="ìˆ˜ë¦¬ë…¼ìˆ ì‹¬ì¸µë©´ì ‘">ìˆ˜ë¦¬ë…¼ìˆ ì‹¬ì¸µë©´ì ‘</option>
        <option value="APë¯¸ì ë¶„">APë¯¸ì ë¶„</option>
      </select>
    </label>
    <div id="pathSelectors">
  <label>êµìœ¡ê³¼ì •:
    <select id="curriculumSelect"></select>
  </label>
  <label>ëŒ€ë‹¨ì›:
    <select id="mainUnitSelect"></select>
  </label>
  <label>ì¤‘ë‹¨ì›:
    <select id="midUnitSelect"></select>
  </label>
  <label>ì†Œë‹¨ì›:
    <select id="subUnitSelect"></select>
  </label>
</div>
<input type="hidden" id="searchPathText">

  </div>

  <div style="border: 1px dashed #aaa; padding: 10px; border-radius: 5px;">
    <label>ìœ í˜•:
      <select id="searchType">
        <option value="">ì „ì²´</option>
        <option value="ì„ íƒí˜•">ì„ íƒí˜•</option>
        <option value="ë‹¨ë‹µí˜•">ë‹¨ë‹µí˜•</option>
        <option value="ì„œìˆ í˜•">ì„œìˆ í˜•</option>
      </select>
    </label>
    <label>ë¶„ë¥˜:
      <select id="searchCategory">
        <option value="">ì „ì²´</option>
        <option value="ê³„ì‚°ëŠ¥ë ¥">ê³„ì‚°ëŠ¥ë ¥</option>
        <option value="ì´í•´ëŠ¥ë ¥">ì´í•´ëŠ¥ë ¥</option>
        <option value="ì¶”ë¡ ëŠ¥ë ¥">ì¶”ë¡ ëŠ¥ë ¥</option>
        <option value="ë‚´ì ë¬¸ì œí•´ê²°ëŠ¥ë ¥">ë‚´ì ë¬¸ì œí•´ê²°ëŠ¥ë ¥</option>
        <option value="ì™¸ì ë¬¸ì œí•´ê²°ëŠ¥ë ¥">ì™¸ì ë¬¸ì œí•´ê²°ëŠ¥ë ¥</option>
      </select>
    </label>
    <label>ë‚œì´ë„:
      <select id="searchDifficulty">
        <option value="">ì „ì²´</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
      </select>
    </label>
    <label>ë³µì‚¬í•œ ì‚¬ëŒ: <input type="text" id="searchCopiedBy" placeholder="ì˜ˆ: admin"></label>
    <label><input type="checkbox" id="searchQuestion"> ë¬¸ì œ ë³¸ë¬¸ë„ í¬í•¨</label>
    <label><input type="checkbox" id="searchInvalidPath"> ê²½ë¡œì—†ìŒ ë¬¸ì œ</label>
 
  </div>

  <button onclick="searchProblems()">ğŸ” ê²€ìƒ‰</button>
  <button onclick="resetFilters()">ğŸ” ì´ˆê¸°í™”</button>
<div id="selectedCount" style="...">
  <span id="selectedCountText">âœ… ì„ íƒëœ ë¬¸ì œ: 0ê°œ</span>
  <button onclick="copySelectedIds()">ğŸ“‹ ID ë³µì‚¬</button>
</div>





</details>



<div style="margin: 10px 0;">
  <strong>ğŸ“‹ ê¸°ë³¸ ë³µì‚¬ í•­ëª© (í•­ìƒ í¬í•¨):</strong>
  ID, ì œëª©, ê²½ë¡œ, ë‚œì´ë„
</div>

<div style="margin: 10px 0;">
  <strong>ğŸ“Œ ì„ íƒ ë³µì‚¬ í•­ëª©:</strong><br>
  <label><input type="checkbox" class="copyOption" value="type"> ìœ í˜•</label>
  <label><input type="checkbox" class="copyOption" value="source"> ì¶œì²˜</label>
  <label><input type="checkbox" class="copyOption" value="tags"> íƒœê·¸</label>
  <label><input type="checkbox" class="copyOption" value="copied_by"> ë³µì‚¬í•œ ì‚¬ëŒ</label>
  <label><input type="checkbox" class="copyOption" value="category"> ë¶„ë¥˜</label>
  <label><input type="checkbox" class="copyOption" value="created_at"> ë“±ë¡ì¼</label>

</div>





<div style="margin: 15px 0; border: 1px solid #aaa; padding: 10px; border-radius: 5px;">
  <strong>ğŸ›  ì„ íƒëœ ë¬¸ì œ ê²½ë¡œ ì¼ê´„ ìˆ˜ì •:</strong>
  <div style="display:flex; gap:10px; flex-wrap:wrap;">
    <select id="bulkCurriculumSelect"></select>
    <select id="bulkMainUnitSelect"></select>
    <select id="bulkMidUnitSelect"></select>
    <select id="bulkSubUnitSelect"></select>
    <input type="number" id="manualPathId" placeholder="path_id ì…ë ¥" style="width:120px" />
    <button onclick="bulkUpdatePath()">ì„ íƒëœ ë¬¸ì œ ê²½ë¡œ ìˆ˜ì •</button>
    <button onclick="window.open('path_tree_view.html', '_blank')">ê²½ë¡œ ID ê²€ìƒ‰</button>
    
  </div>
</div>




<table id="problemsTable">
  <thead>
    <tr>
      <th><input type="checkbox" id="selectAll" onclick="toggleAllCheckboxes(this)"></th> <!-- âœ… ì¶”ê°€ -->
      <th>ID</th>
      <th>ì œëª©</th>
      <th>ê²½ë¡œ</th>
      <th>ìœ í˜•</th>
      <th>ë‚œì´ë„</th>
      <th>ë¶„ë¥˜</th>
      <th>ì¶œì²˜</th>
      <th>íƒœê·¸</th>
      <th>ë“±ë¡ì¼</th>
      <th>ê´€ë¦¬</th>
      <th>ë³µì‚¬í•œ ì‚¬ëŒ</th>
    </tr>
  </thead>
  <tbody>
    <!-- ë¬¸ì œ ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
  </tbody>
</table>

<script>
function loadProblems(query = '') {
  fetch('list_problems.php' + (query ? '?' + query : ''))
    .then(response => response.json())
    .then(data => {
      const tbody = document.querySelector("#problemsTable tbody");
      tbody.innerHTML = '';

      if (data.success) {
        data.data.forEach(problem => {
          const row = document.createElement("tr");

          // âœ… ê³ ì•„ ë¬¸ì œì¼ ê²½ìš° ë°°ê²½ìƒ‰ ì§€ì •
          if (!problem.path_text) {
            row.style.backgroundColor = 'lightpink';
          }

          row.innerHTML = `
            <td><input type="checkbox" class="problemCheckbox" value="${problem.id}"></td>
            <td>${problem.id}</td>
            <td>${problem.title}</td>
            <td>${problem.path_text && problem.path_text.trim() !== '' ? problem.path_text : 'ê²½ë¡œì—†ìŒ'}</td>
            <td>${problem.type}</td>
            <td>${problem.difficulty}</td>
            <td>${problem.category}</td>
            <td>${problem.source}</td>
            <td>${problem.tags ?? ''}</td>
            <td>${problem.created_at}</td>
            <td>
              <button onclick="location.href='edit_problem.php?id=${problem.id}'">ìˆ˜ì •</button>
              <button onclick="deleteProblem(${problem.id})">ì‚­ì œ</button>
              <button onclick="location.href='view_problem.php?id=${problem.id}'">ë³´ê¸°</button>
              ${problem.origin_id ? `<button onclick="location.href='view_problem.php?id=${problem.origin_id}'">ì›ë³¸ ë³´ê¸°</button>` : ''}
            </td>
            <td>${problem.copied_by ?? ''}</td>
          `;
          tbody.appendChild(row);
        });

        // âœ… ì²´í¬ë°•ìŠ¤ ë³µì›ì€ ëª¨ë“  í–‰ ì¶”ê°€ í›„ í•œ ë²ˆë§Œ ì‹¤í–‰
        restoreCheckedProblemIds();
      } else {
        alert('ë¬¸ì œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.');
      }
    })
    .catch(error => {
      console.error('ì—ëŸ¬ ë°œìƒ:', error);
      alert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    });
}

// ì´ˆê¸° ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
loadProblems();

function searchProblems() {
  const params = new URLSearchParams();
  const get = id => document.getElementById(id)?.value.trim();
  const checked = id => document.getElementById(id)?.checked;

  if (get('searchTitle')) params.append('title', get('searchTitle'));
  if (get('searchTags')) params.append('tags', get('searchTags'));
  if (get('searchSource')) params.append('source', get('searchSource'));
  if (get('searchPathText')) params.append('path_text', get('searchPathText'));
  if (get('searchType')) params.append('type', get('searchType'));
  if (get('searchCategory')) params.append('category', get('searchCategory'));
  if (get('searchDifficulty')) params.append('difficulty', get('searchDifficulty'));
  if (get('searchCopiedBy')) params.append('copied_by', get('searchCopiedBy'));
  if (checked('searchQuestion')) params.append('include_question', '1');

  // âœ… ì—¬ê¸° ì¶”ê°€
   if (checked('searchInvalidPath')) params.append('invalid_path', '1');  // âœ… ì´ ì¤„ ì¶”ê°€ë¨
  if (get('searchOrKeyword')) params.append('or', get('searchOrKeyword'));
  if (get('searchNotKeyword')) params.append('not', get('searchNotKeyword'));
  if (get('searchScope')) params.append('scope', get('searchScope'));

  loadProblems(params.toString());
}


function resetFilters() {
  document.querySelectorAll('input, select').forEach(el => {
    if (el.type === 'checkbox') el.checked = false;
    else el.value = '';
  });

  localStorage.removeItem('checkedProblemIds'); // âœ… ì²´í¬ ìƒíƒœ ì´ˆê¸°í™”ë„ ì¶”ê°€
  loadProblems();
}

function deleteProblem(id) {
  if (confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
    fetch(`delete_problem.php?id=${id}`, { method: 'GET' })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          alert('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
          loadProblems();
        } else {
          alert('ì‚­ì œ ì‹¤íŒ¨: ' + data.message);
        }
      })
      .catch(err => {
        alert('ì„œë²„ ì˜¤ë¥˜: ' + err);
      });
  }
}

// ê²½ë¡œ ë“œë¡­ë‹¤ìš´ ë¶ˆëŸ¬ì˜¤ê¸°
function loadPathDropdowns() {
  fetch('get_path_tree_flat_paths.php')
    .then(response => response.json())
    .then(data => {
      const curriculumSelect = document.getElementById('curriculumSelect');
      const mainUnitSelect = document.getElementById('mainUnitSelect');
      const midUnitSelect = document.getElementById('midUnitSelect');
      const subUnitSelect = document.getElementById('subUnitSelect');
      const hiddenPathInput = document.getElementById('searchPathText');

      // ê° select ì´ˆê¸°í™”
      [curriculumSelect, mainUnitSelect, midUnitSelect, subUnitSelect].forEach(select => {
        select.innerHTML = '<option value="">ì„ íƒ</option>';
      });

      // ì „ì²´ ë°ì´í„° ìºì‹œ
      const pathMap = {};
      data.forEach(item => {
        if (!pathMap[item.depth]) pathMap[item.depth] = [];
        pathMap[item.depth].push(item);
      });

      function populateOptions(select, items) {
        select.innerHTML = '<option value="">ì„ íƒ</option>';
        items.forEach(item => {
          const opt = document.createElement('option');
          opt.value = item.id;
          opt.textContent = item.name;
          select.appendChild(opt);
        });
      }

      populateOptions(curriculumSelect, pathMap[1] || []);

      curriculumSelect.addEventListener('change', () => {
        const val = curriculumSelect.value;
        const children = data.filter(p => p.parent_id == val);
        populateOptions(mainUnitSelect, children);
        populateOptions(midUnitSelect, []);
        populateOptions(subUnitSelect, []);
        updatePathText();
      });

      mainUnitSelect.addEventListener('change', () => {
        const val = mainUnitSelect.value;
        const children = data.filter(p => p.parent_id == val);
        populateOptions(midUnitSelect, children);
        populateOptions(subUnitSelect, []);
        updatePathText();
      });

      midUnitSelect.addEventListener('change', () => {
        const val = midUnitSelect.value;
        const children = data.filter(p => p.parent_id == val);
        populateOptions(subUnitSelect, children);
        updatePathText();
      });

      subUnitSelect.addEventListener('change', () => {
        updatePathText();
      });

      function updatePathText() {
        const ids = [
          curriculumSelect.value,
          mainUnitSelect.value,
          midUnitSelect.value,
          subUnitSelect.value
        ].filter(Boolean);

        const names = ids.map(id => {
          const match = data.find(p => p.id == id);
          return match ? match.name : '';
        }).filter(Boolean);

        hiddenPathInput.value = names.join('/');
      }
    });
}

function getBulkSelectedPathText() {
  const ids = [
    'bulkCurriculumSelect',
    'bulkMainUnitSelect',
    'bulkMidUnitSelect',
    'bulkSubUnitSelect'
  ];

  const names = ids.map(id => {
    const el = document.getElementById(id);
    if (!el) return '';
    const selected = el.options[el.selectedIndex];
    return selected ? selected.textContent : '';
  }).filter(name => name && name !== 'ì„ íƒ');

  return names.join('/');
}

function getBulkSelectedPathId() {
  const subId = document.getElementById('bulkSubUnitSelect')?.value;
  const midId = document.getElementById('bulkMidUnitSelect')?.value;
  const mainId = document.getElementById('bulkMainUnitSelect')?.value;
  const curriculumId = document.getElementById('bulkCurriculumSelect')?.value;

  // ê°€ì¥ êµ¬ì²´ì ì¸ ê²½ë¡œë¶€í„° ì²´í¬í•˜ì—¬ path_idë¡œ ì‚¬ìš©
  return subId || midId || mainId || curriculumId || null;
}


function bulkUpdatePath() {
  const manualPathIdInput = document.getElementById('manualPathId');
  const manualPathId = manualPathIdInput?.value.trim();
  const finalPathId = manualPathId || getBulkSelectedPathId();

  const newPath = getBulkSelectedPathText(); // â† ë¹„ì–´ ìˆì„ ìˆ˜ë„ ìˆìŒ

  if (!newPath && !finalPathId) {
    alert('ì ìš©í•  ê²½ë¡œë¥¼ ì„ íƒí•˜ì„¸ìš”.');
    return;
  }

  const selectedCheckboxes = document.querySelectorAll('.problemCheckbox:checked');
  const selectedIds = Array.from(selectedCheckboxes).map(cb => cb.value);

  if (selectedIds.length === 0) {
    alert('ì„ íƒëœ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤.');
    return;
  }

  if (!confirm(`${selectedIds.length}ê°œì˜ ë¬¸ì œì— ì„ íƒí•œ ê²½ë¡œë¥¼ ì ìš©í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;

  fetch('update_bulk_path.php', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      ids: selectedIds,
      path_text: newPath,
      path_id: finalPathId
    })
  })
  .then(res => res.json())
  .then(data => {
    if (data.success) {
      alert(`ì´ ${data.updated}ê°œì˜ ë¬¸ì œì— ê²½ë¡œê°€ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.`);

      saveCheckedProblemIds();  // âœ… ì²´í¬ ìƒíƒœ ì €ì¥
      loadProblems();           // ğŸ”„ ìƒˆë¡œê³ ì¹¨
    } else {
      alert('ì ìš© ì‹¤íŒ¨: ' + data.message);
    }
  })
  .catch(err => {
    alert('ì„œë²„ ì˜¤ë¥˜: ' + err);
  });
}


function toggleAllCheckboxes(masterCheckbox) {
  const checkboxes = document.querySelectorAll('.problemCheckbox');
  checkboxes.forEach(cb => cb.checked = masterCheckbox.checked);
  updateSelectedCount();  // âœ… ì¶”ê°€
}

function loadBulkPathDropdowns() {
  fetch('get_path_tree_flat_paths.php')
    .then(response => response.json())
    .then(data => {
      const bulkCurriculum = document.getElementById('bulkCurriculumSelect');
      const bulkMainUnit = document.getElementById('bulkMainUnitSelect');
      const bulkMidUnit = document.getElementById('bulkMidUnitSelect');
      const bulkSubUnit = document.getElementById('bulkSubUnitSelect');

      [bulkCurriculum, bulkMainUnit, bulkMidUnit, bulkSubUnit].forEach(select => {
        select.innerHTML = '<option value="">ì„ íƒ</option>';
      });

      const pathMap = {};
      data.forEach(item => {
        if (!pathMap[item.depth]) pathMap[item.depth] = [];
        pathMap[item.depth].push(item);
      });

      function populateOptions(select, items) {
        select.innerHTML = '<option value="">ì„ íƒ</option>';
        items.forEach(item => {
          const opt = document.createElement('option');
          opt.value = item.id;
          opt.textContent = item.name;
          select.appendChild(opt);
        });
      }

      populateOptions(bulkCurriculum, pathMap[1] || []);

      bulkCurriculum.addEventListener('change', () => {
        const children = data.filter(p => p.parent_id == bulkCurriculum.value);
        populateOptions(bulkMainUnit, children);
        populateOptions(bulkMidUnit, []);
        populateOptions(bulkSubUnit, []);
      });

      bulkMainUnit.addEventListener('change', () => {
        const children = data.filter(p => p.parent_id == bulkMainUnit.value);
        populateOptions(bulkMidUnit, children);
        populateOptions(bulkSubUnit, []);
      });

      bulkMidUnit.addEventListener('change', () => {
        const children = data.filter(p => p.parent_id == bulkMidUnit.value);
        populateOptions(bulkSubUnit, children);
      });
    })
    .catch(err => {
      console.error('ê²½ë¡œ ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:', err);
      alert('ê²½ë¡œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.');
    });
}




// DOMì´ ë¡œë”©ë˜ë©´ ì‹¤í–‰
document.addEventListener('DOMContentLoaded', () => {
  loadPathDropdowns();
  loadBulkPathDropdowns();

  // âœ… ì´ë²¤íŠ¸ ìœ„ì„ ì¶”ê°€
  document.querySelector("#problemsTable tbody").addEventListener("click", function (e) {
    if (e.target.classList.contains("problemCheckbox")) {
      updateSelectedCount();
      saveCheckedProblemIds();
    }
  });
});


// âœ… ì²´í¬ëœ ë¬¸ì œ ID ì €ì¥
function saveCheckedProblemIds() {
  const checkedIds = Array.from(document.querySelectorAll('.problemCheckbox:checked')).map(cb => cb.value);
  localStorage.setItem('checkedProblemIds', JSON.stringify(checkedIds));
}

// âœ… ì²´í¬ëœ ë¬¸ì œ ID ë³µì›
function restoreCheckedProblemIds() {
  const savedIds = JSON.parse(localStorage.getItem('checkedProblemIds') || '[]');
  const checkboxes = document.querySelectorAll('.problemCheckbox');
  checkboxes.forEach(cb => {
    if (savedIds.includes(cb.value)) cb.checked = true;
  });
  updateSelectedCount();  // âœ… ì¶”ê°€
}


function updateSelectedCount() {
  const count = document.querySelectorAll('.problemCheckbox:checked').length;
  document.getElementById('selectedCountText').textContent = `âœ… ì„ íƒëœ ë¬¸ì œ: ${count}ê°œ`;
}

function copySelectedIds() {
  const selected = document.querySelectorAll('.problemCheckbox:checked');
  if (selected.length === 0) {
    alert('ë³µì‚¬í•  ë¬¸ì œê°€ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
    return;
  }

  const defaultFields = ['id', 'title', 'path', 'difficulty'];
  const optionalFields = Array.from(document.querySelectorAll('.copyOption:checked')).map(cb => cb.value);
  const allFields = [...defaultFields, ...optionalFields];

  const copiedRows = [];

  selected.forEach(cb => {
    const row = cb.closest('tr');
    const fieldMap = {
      id: row.children[1].textContent,
      title: row.children[2].textContent,
      path: row.children[3].textContent,
      type: row.children[4].textContent,
      difficulty: row.children[5].textContent,
      category: row.children[6].textContent,
      source: row.children[7].textContent,
      tags: row.children[8].textContent,
      created_at: row.children[9].textContent,
      copied_by: row.children[11].textContent,
    };

    const rowData = allFields.map(field => `${field.toUpperCase()}: ${fieldMap[field]}`).join(' | ');
    copiedRows.push(rowData);
  });

  const textToCopy = copiedRows.join('\n');

  navigator.clipboard.writeText(textToCopy)
    .then(() => {
      // âœ… 1. ë²„íŠ¼ ìš”ì†Œ ì°¾ì•„ì„œ ìŠ¤íƒ€ì¼ ë° í…ìŠ¤íŠ¸ ë³€ê²½
      const button = document.querySelector('button[onclick="copySelectedIds()"]');
      button.style.backgroundColor = '#4caf50';  // ì´ˆë¡ìƒ‰
      button.style.color = 'white';
      button.textContent = `âœ… ë³µì‚¬ ì™„ë£Œ (${copiedRows.length}ê°œ)`;

      // âœ… 2. ì¼ì • ì‹œê°„ ë’¤ ì›ë˜ëŒ€ë¡œ ë˜ëŒë¦¬ê¸°
      setTimeout(() => {
        button.style.backgroundColor = '';
        button.style.color = '';
        button.textContent = 'ğŸ“‹ ID ë³µì‚¬';
      }, 1500);

      // âœ… 3. ìƒë‹¨ alertBoxë„ í•¨ê»˜ í‘œì‹œ
      const alertBox = document.getElementById('copyAlert');
      alertBox.style.display = 'block';
      alertBox.textContent = `ë³µì‚¬ ì™„ë£Œ (${copiedRows.length}ê°œ ë¬¸ì œ)`;
      setTimeout(() => {
        alertBox.style.display = 'none';
      }, 2000);
    })
    .catch(err => {
      console.error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:', err);
      alert('ë³µì‚¬ ì‹¤íŒ¨');
    });
}



</script>
<script>
// âœ… ìƒˆë¡œê³ ì¹¨ ì „ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì €ì¥
window.addEventListener("beforeunload", function () {
  localStorage.setItem("scrollY", window.scrollY);
});

// âœ… í˜ì´ì§€ ë¡œë“œ ì‹œ ìŠ¤í¬ë¡¤ ë³µì›
window.addEventListener("DOMContentLoaded", function () {
  const savedY = localStorage.getItem("scrollY");
  if (savedY) window.scrollTo(0, parseInt(savedY));
});
</script>

<div id="copyAlert" style="
  position: fixed;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  background-color: #4caf50;
  color: white;
  padding: 10px 20px;
  border-radius: 5px;
  display: none;
  z-index: 9999;
  font-weight: bold;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
">
  ë³µì‚¬ ì™„ë£Œ!
</div>



</body>
</html>
